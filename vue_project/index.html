<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ðŸŽ® PlayStation Game Explorer</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/vue@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.3/gsap.min.js"></script>
</head>
<body>
  <div id="app">
    <h1>ðŸŽ® Explore Popular PlayStation Games</h1>

    <div class="loading" v-if="loading">Loading awesome games...</div>
    <div class="error" v-if="error">{{ error }}</div>

    <div class="game-list">
      <div v-for="game in games" :key="game.id" class="game" @click="fetchDetails(game.id)">
        <img :src="game.image_url" :alt="game.title" />
        <h3>{{ game.title }}</h3>
        <p><strong>Genre:</strong> {{ game.genre.name }}</p>
      </div>
    </div>

    <div v-if="selectedGame" id="details">
      <h2>{{ selectedGame.title }}</h2>
      <p><strong>Genre:</strong> {{ selectedGame.genre.name }}</p>
      <p>{{ selectedGame.description }}</p>
      <img :src="selectedGame.image_url" :alt="selectedGame.title" />
    </div>
  </div>

  <script>
    new Vue({
      el: '#app',
      data: {
        games: [],
        selectedGame: null,
        loading: true,
        error: null
      },
      created() {
        axios.get('http://localhost:8000/api/games')
          .then(response => {
            this.games = response.data;
            this.loading = false;
          })
          .catch((error) => {
            console.error("Error loading games:", error); 
            this.error = "Oops! Something went wrong while loading games.";
            this.loading = false;
          });
      },
      methods: {
        fetchDetails(id) {
          this.selectedGame = null;
          this.loading = true;
          axios.get(`http://localhost:8000/api/games/${id}`)
            .then(response => {
              this.selectedGame = response.data;
              this.loading = false;
              this.$nextTick(() => {
                gsap.from("#details", { opacity: 0, y: 20, duration: 0.5 });
              });
            })
            .catch((error) => {
              console.error("Error loading game details:", error); 
              this.error = "Unable to load game details right now.";
              this.loading = false;
            });
        }
      }
    });
  </script>
</body>
</html>
